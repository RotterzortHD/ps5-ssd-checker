---
// src/pages/steam-deck.astro
import Layout from '../layouts/Layout.astro';
import ssds from '../data/ssds.json';
import { checkCompatibility } from '../utils/checkCompatibility';
import '../global.css'; 

// Filter: Nur SSDs anzeigen, die ins Steam Deck passen (2230)
const steamDeckSSDs = ssds.filter(ssd => ssd.compatibility.includes('steam-deck'));
const sortedSSDs = steamDeckSSDs.sort((a, b) => a.name.localeCompare(b.name));
---

<Layout title="Steam Deck SSD Speichererweiterung | Kompatibilitäts-Check">
  <main class="max-w-4xl mx-auto px-6 py-20">
    
    <div class="text-center mb-16">
      <h1 class="text-5xl md:text-7xl font-extrabold mb-6 tracking-tight">
        Steam Deck <span class="text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-400">Upgrade</span>
      </h1>
      <p class="text-xl text-slate-400 max-w-2xl mx-auto leading-relaxed">
        Finde die perfekte M.2 2230 SSD für dein Steam Deck oder ROG Ally.
        Wir zeigen dir nur Modelle, die wirklich passen.
      </p>
    </div>

    <div class="grid gap-4">
      {sortedSSDs.map((ssd) => {
        // Hier rufen wir den Check speziell für Steam Deck auf
        const check = checkCompatibility(ssd, 'steam-deck');
        
        return (
        <div class="group relative block">
          <div class="absolute inset-0 bg-gradient-to-r from-orange-500/0 via-orange-500/0 to-orange-500/0 group-hover:from-orange-500/5 transition duration-500 rounded-xl"></div>
          
          <div class="bg-white/5 hover:bg-white/10 border border-white/5 hover:border-white/20 backdrop-blur-sm rounded-xl p-6 transition-all duration-300 flex items-center justify-between">
              
              <div class="flex items-center gap-4">
                  <div class="w-10 h-10 rounded-lg bg-slate-800 flex items-center justify-center text-xs font-bold text-slate-400 border border-slate-700">
                      {ssd.brand.substring(0,2).toUpperCase()}
                  </div>
                  <div>
                      <h2 class="font-bold text-lg text-slate-200 group-hover:text-white transition">{ssd.name}</h2>
                      <p class="text-sm text-slate-500 font-mono">{ssd.capacity_gb} GB • {ssd.form_factor}</p>
                  </div>
              </div>

              <div class="flex items-center gap-4">
                 <span class={`px-3 py-1 rounded-full text-xs font-bold border ${check.colorClass}`}>
                    {check.title}
                 </span>
                 
                 <a href={`https://www.amazon.de/dp/${ssd.asin}?tag=ps5ssd21-21`} target="_blank" class="bg-white text-black px-4 py-2 rounded-lg text-sm font-bold hover:bg-slate-200 transition">
                    Zum Preis
                 </a>
              </div>

          </div>
        </div>
      )})}
    </div>

    {steamDeckSSDs.length === 0 && (
        <div class="text-center text-slate-500 py-12">
            Aktuell keine SSDs gefunden. Wir füllen die Datenbank gerade auf!
        </div>
    )}

  </main>
</Layout>